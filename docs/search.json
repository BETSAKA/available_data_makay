[
  {
    "objectID": "02_climat.html",
    "href": "02_climat.html",
    "title": "3  Climat",
    "section": "",
    "text": "3.1 Précipitations\nNous utilisons les données CHIRPS de la NASA pour estimer la pluviométrie moyenne sur 3 jours dans la zone protégée de Makay. Les données sources ont une résolution spatiale de 0,05° (environ 5 km). Nous traitons les données à l’aide du package mapme.biodiversity (Görgen and Bhandari 2023).\nCode\nlibrary(aws.s3)\nlibrary(tidyverse) # toolkit for data manipulation\nlibrary(geodata) # to get municipalities\nlibrary(sf) # to handle spatial data (vectors)\nlibrary(terra) # to handle patial data (rasters)\nlibrary(mapme.biodiversity) # to compute spatial indicators\nlibrary(tmap) # nice maps\nlibrary(zoo) # time series\nlibrary(units) # ensures units are right\nlibrary(future) # to parallelize computations\nlibrary(exactextractr) # engine for mapme.biodiversity\nlibrary(SPEI) # to compute rainfall  \n\nmakay_ap &lt;- st_read(\"data/Makay_wgs84.geojson\", quiet = TRUE) %&gt;% \n  rename(Statut = SOURCETHM) %&gt;% \n  mutate(Statut = recode(Statut, \"zone tampon\" = \"Zone tampon\"))\n\n# Fist we dissolve the different areas\nmakay_union &lt;- makay_ap %&gt;% \n  st_union() %&gt;% \n  st_sf() %&gt;% \n  st_make_valid()\n\n# We group Makay PA zones and communes to have an object with all areas of interest\n# We keep only one common field \"name\"\naoi &lt;- makay_union\n\n# we use parallel computing to reduce processing time\nplan(multisession, workers = 8)\n\n\n\naoi_1 &lt;- s3read_using(FUN = read_rds, object = \"diffusion/makay/aoi_1.rds\",\n                      bucket = \"fbedecarrats\", opts = list(\"region\" = \"\"))\n\n# We compute 3d average precipitations\nprecip_3d &lt;- aoi_1 %&gt;%\n  unnest(precipitation_chirps) %&gt;%\n  group_by(name) %&gt;%\n  mutate(rainfall_3d_mean = rollmean(absolute, k = 3, fill = NA))\n\n# We display precipitations for Makay area\nprecip_3d %&gt;%\n  filter(name == \"AP Makay : Ensemble\") %&gt;%\n  ggplot(aes(x = dates, y = rainfall_3d_mean)) +\n  geom_line()\n\n\n\n\n\nPrécipitations sur l’AP Makay (source : CHIRPS, moyenne mobile sur 3 jours)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Climat</span>"
    ]
  },
  {
    "objectID": "02_climat.html#cyclones",
    "href": "02_climat.html#cyclones",
    "title": "3  Climat",
    "section": "3.2 Cyclones",
    "text": "3.2 Cyclones\nNous utilisons les données de suivu du climat IBTrACS pour obtenir l’historique des trajectoires des cyclones et les attributs des cyclones (Knapp et al. 2010). Cette procédure est fortement inspirée du code source de mapme.protectedareas (Schielein 2023).\n\n\nCode\nif (!file.exists(\"data/ibtracs/IBTrACS.since1980.list.v04r00.lines.shp\")) {\n  dir.create(\"data/ibtracs\")\n  download.file(url = \"https://www.ncei.noaa.gov/data/international-best-track-archive-for-climate-stewardship-ibtracs/v04r00/access/shapefile/IBTrACS.since1980.list.v04r00.lines.zip\", \n                destfile = \"data/ibtracs/ibtracs_lines.zip\")\n  unzip(\"data/ibtracs/ibtracs_lines.zip\", exdir = \"data/ibtracs\")\n}\n\nmada &lt;- gadm(\"MDG\", level=0, path = \"data\") %&gt;%\n  st_as_sf()\n\n# column description is given here: https://www.ncei.noaa.gov/sites/default/files/2021-07/IBTrACS_v04_column_documentation.pdf\ncyclones &lt;- read_sf(\"data/ibtracs/IBTrACS.since1980.list.v04r00.lines.shp\")\n\n# Create a buffer 300km around Madagascar\nmada_buff &lt;- st_buffer(mada, 300)\n\ncyclones$wind_combined &lt;- cyclones %&gt;%\n  select(contains(\"WIND\")) %&gt;%\n  select(-WMO_WIND) %&gt;%\n  st_drop_geometry() %&gt;%\n  rowMeans(., na.rm = T)\n\ncyclones_mada &lt;- cyclones %&gt;%\n  st_intersection(mada_buff) %&gt;%\n  select(Season = SEASON, Name = NAME, Winds_in_knots = wind_combined)\n\ntmap_mode(\"view\")\ntm_shape(makay_union) + \n  tm_borders(col = \"darkgreen\") + \n  tm_shape(cyclones_mada) +\n  tm_lines(col = \"Season\", lwd = \"Winds_in_knots\", scale = 3, palette = \"Blues\",\n           popup.vars = c(\"Name\", \"Season\", \"Winds in knots\" = \"Winds_in_knots\"),\n           legend.format = list(big.mark=\"\"), popup.format = list(big.mark=\"\"))",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Climat</span>"
    ]
  },
  {
    "objectID": "03_feux.html",
    "href": "03_feux.html",
    "title": "4  Feux",
    "section": "",
    "text": "4.1 Feux au cours de l’année écoulée\nPour cette visualisation, nous avons mobilisé des données provenant du satellite VIIRS (Visible Infrared Imaging Radiometer Suite). Les données téléchargées depuis le service FIRMS de la NASA portent uniquement sur les douze derniers mois. Elles incluent plusieurs variables, parmi lesquelles nous utilisons principalement la variable ‘frp’ (Fire Radiative Power) pour représenter l’intensité des incendies. Cette variable, exprimée en mégawatts (MW), quantifie le taux d’émission radiative des feux actifs, offrant une indication directe de l’intensité du feu. De plus, nous avons défini une zone d’intérêt de 20km autour de l’aire protégée et nous visualisons les données à l’intérieur de cette zone. La carte finale montre ces incendies avec une gradation de couleurs pour refléter l’intensité de chaque incendie.En cliquant sur les points, on peut consulter la date à laquelle le foyer a été enregistré par le satellite, ainsi que la probabilité qu’il s’agisse téellement d’un feu (classé en “élevée”, “nominale” et “faible”).\nCode\n# Ci-dessous les librairies R utilisées pour cette analyse\nlibrary(tidyverse) # pour la manipulation et visualisation de données\nlibrary(sf) # pour traiter les données spatiales\nlibrary(tmap) # pour générer des cartes\nlibrary(aws.s3) # Pour accéder aux données volumineuses stockées en ligne\nlibrary(geodata) # Pour avoir les frontières administratives\nlibrary(curl) # Pour télécharge\nlibrary(lubridate) # Pour manipuler des dates\nlibrary(httr)\nlibrary(mapme.biodiversity)\nlibrary(units)\nlibrary(arrow)\nCode\n# Create a dataframe of the coordinates\ncoordinates &lt;- data.frame(\n  location = c(\"Beroroha\", \"Beronono\", \"Tsivoko\", \"Makaykely\"),\n  latitude = c(\"21°40.504’S\", \"21°21.669’S\", \"21°17.712’S\", \"21°28.074’S\"),\n  longitude = c(\"45°9.571’E\", \"45°14.885’E\", \"45°22.732’E\", \"45°21.896’E\")\n)\n\n# Function to parse DMS and convert to decimal degrees\nddm_to_decimal &lt;- function(dms){\n  # Extraire les degrés, minutes et secondes\n  parts &lt;- regmatches(dms, gregexpr(\"[0-9.]+\", dms))[[1]]\n  degree &lt;- as.numeric(parts[1])\n  minute &lt;- as.numeric(parts[2]) / 60\n  direction &lt;- ifelse(grepl(\"S|W\", dms), -1, 1)\n  \n  # Converstion au format décimal\n  decimal &lt;- direction * (degree + minute)\n  \n  return(decimal)\n}\n\n# Apply function to each coordinate\ncoordinates$latitude_decimal &lt;- sapply(coordinates$latitude, ddm_to_decimal)\ncoordinates$longitude_decimal &lt;- sapply(coordinates$longitude, ddm_to_decimal)\n\n# Convertir les coordonnées en objet sf\ncoordinates_sf &lt;- st_as_sf(coordinates, \n                           coords = c(\"longitude_decimal\", \"latitude_decimal\"), \n                           crs = 4326)\n\n\nmakay_ap &lt;- st_read(\"data/Makay_wgs84.geojson\", quiet = TRUE) %&gt;%\n  rename(Statut = SOURCETHM) %&gt;%\n  mutate(Statut = recode(Statut, \"zone tampon\" = \"Zone tampon\"))\n\n# Fusion des différentes aires\nmakay_union &lt;- makay_ap %&gt;%\n  st_union() %&gt;%\n  st_sf() %&gt;%\n  st_make_valid()\n\n# Define the buffer size (in kilometers) for the square expansion\nbuffer_size_km &lt;- 20\n\n# Create a 20km buffer around Makay PA\nmakay_buffer &lt;- makay_union %&gt;%\n  st_buffer(dist = set_units(buffer_size_km, km)) %&gt;%\n  st_as_sf()\n\n# Manual request at https://firms.modaps.eosdis.nasa.gov/download/create.php\n# Uses the following coordinates : 44.4,-22.4,46.4,-19.9\n# For VIIRS NOAA-20\nfirms_focus &lt;- read_csv(\"firms_manual.csv\") %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %&gt;%\n  filter(lengths(st_within(., makay_buffer)) &gt; 0)\n\n\nbreaks_frp &lt;- c(min(firms_focus$frp), \n                median(firms_focus$frp), \n                max(firms_focus$frp))\nbreaks_frp_5 &lt;- quantile(firms_focus$frp, probs = seq(0, 1, by = 0.25), \n                         na.rm = TRUE)\ntmap_mode(\"view\")\ntm_shape(firms_focus) +\n  tm_dots(col = \"frp\", size = 1, alpha = 0.2,\n          palette = c(\"blue\", \"cyan\", \"yellow\", \"orange\", \"red\"),\n          border.col = NULL, breaks = breaks_frp_5,\n          popup.vars = c(\"acq_date\", \"confidence\", \"frp\"),\n          title = \"Fire radiative power\") +\n  tm_layout(title = \"Feux détectés autour du Malay\") +\n  tm_shape(makay_union) +\n  tm_borders(col = \"darkblue\") + \n  tm_shape(coordinates_sf) +\n  tm_dots(col = \"black\", size = 0.1, labels = coordinates_sf$location) +\n  tm_view(set.view = 10) +\n  tm_text(text = \"location\", ymod = -0.5) +\n  tm_basemap(\"OpenStreetMap\") +\n  tm_scale_bar()",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Feux</span>"
    ]
  },
  {
    "objectID": "04_forets.html",
    "href": "04_forets.html",
    "title": "5  Forêts",
    "section": "",
    "text": "On veut aussi observer des événements de déforestation qui auraient eu lieu récemment. Pour cela, nous utilisons le jeu de données GFC. Ce jeu de données est dérivé des observations de Landsat, permettant de cartographier les étendues forestières et de suivre les changements au fil du temps à l’échelle mondiale avec une résolution de 30 mètres (Hansen et al. 2013). Ce jeu de données distingue entre la couverture forestière en 2000 et les pertes survenues chaque année de 2001 à 2022. C’est un outil pratique qui a été largement adopté pour évaluer l’impact des zones protégées sur la perte forestière. Cependant, le jeu de données du GFC a des limites, dont des erreurs potentielles de classification pour les écosystèmes forestiers atypiques ou les difficultés à distinguer entre forêt naturelle et plantations d’arbres. Ces défis pourraient s’avérer cruciaux pour les biomes secs où le jeu de données sur la couverture forestière mondiale est connu pour sous-estimer la couverture et la perte forestière. Ci-dessous, nous présentons les données les plus récentes disponibles, en distinguant les pertes de couverture forestière survenues avant 2022 et celles survenues entre 2022 et 2024.\n\n\nCode\n# Ci-dessous les librairies R utilisées pour cette analyse\nlibrary(tidyverse) # pour la manipulation et visualisation de données\nlibrary(sf) # pour traiter les données spatiales\nlibrary(tmap) # pour générer des cartes\nlibrary(aws.s3) # Pour accéder aux données volumineuses stockées en ligne\nlibrary(geodata) # Pour avoir les frontières administratives\nlibrary(curl) # Pour télécharge\nlibrary(lubridate) # Pour manipuler des dates\nlibrary(httr)\nlibrary(mapme.biodiversity)\nlibrary(units)\n\n# Create a dataframe of the coordinates\ncoordinates &lt;- data.frame(\n  location = c(\"Beroroha\", \"Beronono\", \"Tsivoko\", \"Makaykely\"),\n  latitude = c(\"21°40.504’S\", \"21°21.669’S\", \"21°17.712’S\", \"21°28.074’S\"),\n  longitude = c(\"45°9.571’E\", \"45°14.885’E\", \"45°22.732’E\", \"45°21.896’E\")\n)\n\n# Function to parse DMS and convert to decimal degrees\nddm_to_decimal &lt;- function(dms){\n  # Extraire les degrés, minutes et secondes\n  parts &lt;- regmatches(dms, gregexpr(\"[0-9.]+\", dms))[[1]]\n  degree &lt;- as.numeric(parts[1])\n  minute &lt;- as.numeric(parts[2]) / 60\n  direction &lt;- ifelse(grepl(\"S|W\", dms), -1, 1)\n  \n  # Converstion au format décimal\n  decimal &lt;- direction * (degree + minute)\n  \n  return(decimal)\n}\n\n\n# Apply function to each coordinate\ncoordinates$latitude_decimal &lt;- sapply(coordinates$latitude, ddm_to_decimal)\ncoordinates$longitude_decimal &lt;- sapply(coordinates$longitude, ddm_to_decimal)\n\n# Convertir les coordonnées en objet sf\ncoordinates_sf &lt;- st_as_sf(coordinates, \n                           coords = c(\"longitude_decimal\", \"latitude_decimal\"), \n                           crs = 4326)\n\n\nmakay_ap &lt;- st_read(\"data/Makay_wgs84.geojson\", quiet = TRUE) %&gt;%\n  rename(Statut = SOURCETHM) %&gt;%\n  mutate(Statut = recode(Statut, \"zone tampon\" = \"Zone tampon\"))\n\n# Fusion des différentes aires\nmakay_union &lt;- makay_ap %&gt;%\n  st_union() %&gt;%\n  st_sf() %&gt;%\n  st_make_valid()\n\n\nbuff_size &lt;- 20\n  # Create a 20km buffer around Makay PA\n  buffer &lt;- makay_union %&gt;%\n    st_buffer(dist = set_units(buff_size, km)) %&gt;%\n    st_as_sf() \n  makay_ext_buffer &lt;- buffer %&gt;%\n    st_difference(makay_union)\n  \n  aoi &lt;- makay_union %&gt;%\n    bind_rows(makay_ext_buffer) %&gt;% \n    st_cast(\"POLYGON\") %&gt;%\n    mutate(name = c(\"Makay\", \"Périphérie 20km\"))\n  \n  tc_2000 &lt;- rast(\"/vsis3/projet-betsaka/diffusion/PA-impact-on-deforestation/mapme/gfw_treecover/Hansen_GFC-2024-v1.12_treecover2000_20S_040E.tif\") %&gt;%\n    crop(buffer)  %&gt;%\n    aggregate(fact = 4, fun = max)\n\n\n\n|---------|---------|---------|---------|\n=========================================\n                                          \n\n\nCode\n  lossyear &lt;- rast(\"/vsis3/projet-betsaka/diffusion/PA-impact-on-deforestation/mapme/gfw_lossyear/Hansen_GFC-2024-v1.12_lossyear_20S_040E.tif\") %&gt;%\n    crop(buffer) %&gt;%\n    aggregate(fact = 4, fun = max)\n\n\n\n|---------|---------|---------|---------|\n=========================================\n                                          \n\n\nCode\n  loss &lt;- lossyear\n  values(loss) &lt;- ifelse(values(lossyear) &gt; 0, 1, NA)\n  loss_recent &lt;- lossyear\n  values(loss_recent) &lt;- ifelse(values(lossyear) &gt; 21, 1, NA)\n  \n  tmap_mode(\"view\")\n  tm_shape(tc_2000) +\n    tm_raster(title = \"Forest cover in 2000 (%)\", palette = \"YlGn\", style = \"cont\") +\n    tm_shape(loss) + \n    tm_raster(title = \"Forest cover loss 2001-2021\", \n              style = \"cat\", breaks = c(0, 0.5, 1.5), palette = \"red\") +\n    tm_shape(loss_recent) + \n    tm_raster(title = \"Forest cover loss 2022-2024\", \n              style = \"cat\", breaks = c(0, 0.5, 1.5), palette = \"purple\") +\n    tm_shape(makay_union) + \n    tm_borders(col = \"darkblue\") + \n    tm_layout(legend.outside = TRUE) + \n    tm_add_legend(type = \"line\", labels = \"Makay PA delimitation\", \n                  col = \"darkblue\") + \n    tm_shape(coordinates_sf) +\n    tm_dots(col = \"black\", size = 0.1, labels = coordinates_sf$location) +\n    tm_text(text = \"location\", ymod = -0.5) +\n    tm_view(set.view = c(10)) +\n    tm_scale_bar()",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Forêts</span>"
    ]
  },
  {
    "objectID": "01_carte_generale.html",
    "href": "01_carte_generale.html",
    "title": "2  Carte générale",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\nlibrary(tmap)\nlibrary(sf)\nlibrary(units)\nlibrary(methods)\n\n\nmakay_ap &lt;- st_read(\"data/Makay_wgs84.geojson\", quiet = TRUE) %&gt;% \n  rename(Statut = SOURCETHM) %&gt;% \n  mutate(Statut = recode(Statut, \"zone tampon\" = \"Zone tampon\"))\n\n# Fist we dissolve the different areas\nmakay_union &lt;- makay_ap %&gt;% \n  st_union() %&gt;% \n  st_sf() %&gt;% \n  st_make_valid()\n\n# Define the buffer size (in kilometers) for the square expansion\nbuffer_size_km &lt;- 60\n\n# Create a 20km buffer around Makay PA\nmakay_buffer &lt;- makay_union %&gt;%\n  st_buffer(dist = set_units(buffer_size_km, km)) %&gt;%\n  st_as_sf()\n\n# Load population estimations\npop &lt;- read_csv(\"data/population/mdg_admpop_adm4_2018.csv\") %&gt;%\n  select(ADM4_PCODE, pop = T_TL)\n\n# Read administrative area boundaries\ncommunes &lt;- st_read(\n  \"data/OCHA_BNGRC admin boundaries/mdg_admbnda_adm3_BNGRC_OCHA_20181031.shp\",\n  quiet = TRUE) %&gt;% \n  st_make_valid()\nfokontany &lt;- st_read(\n  \"data/OCHA_BNGRC admin boundaries/mdg_admbnda_adm4_BNGRC_OCHA_20181031.shp\",\n  quiet = TRUE) %&gt;% \n  st_make_valid()\nplaces &lt;- st_read(\n  \"data/OCHA_BNGRC populated places/mdg_pplp_places_NGA_OCHA.shp\",\n  quiet = TRUE)\n\n# Crop communes and fokontany using the square buffer\ncropped_communes &lt;- communes %&gt;%\n  filter(st_intersects(., makay_buffer, sparse = FALSE))\ncropped_fokontany &lt;- fokontany %&gt;% \n  filter(ADM3_PCODE %in% cropped_communes$ADM3_PCODE) %&gt;% \n  left_join(pop, by = \"ADM4_PCODE\") %&gt;%\n  rename(Commune = ADM3_EN, Fokontany = ADM4_EN,\n         `Population 2018 (estimation)` = pop)\ncropped_places &lt;- places %&gt;% \n  mutate(ADM3_PCODE = str_replace(COM_PCODE, \"MDG\", \"MG\"),\n         FOKONTANY_DEB = str_remove(DISTRICT, \"Ville I\")) %&gt;%\n  filter(ADM3_PCODE %in% cropped_communes$ADM3_PCODE) %&gt;%\n  mutate(Chef_lieu = case_when(\n    str_starts(FOKONTANY, PLACE_NAME) & str_starts(FOKONTANY, DISTRICT) ~ \n      \"District\",\n    str_starts(FOKONTANY, PLACE_NAME)   & str_starts(FOKONTANY, COMMUNE) \n    ~ \"Commune\",\n    str_starts(FOKONTANY, PLACE_NAME)  ~ \"Fokontany\",\n    .default = \"\"),\n    Chef_lieu = factor(Chef_lieu, levels = c(\"\", \"Fokontany\", \n                                             \"Commune\", \"District\")),\n    size_dot = case_when(\n      Chef_lieu == \"\" ~ 0.001,\n      Chef_lieu == \"Fokontany\" ~ 0.002, \n      Chef_lieu == \"Commune\" ~ 0.005,\n      Chef_lieu == \"District\" ~ 0.007,\n      .default = 0.001))\n    \n\n# tm_shape(makay_ap, name = \"Zones de l'AP\") +\n#   tm_polygons(col = \"Statut\", alpha = 0.5) +\ntmap_mode(\"view\")\ntm_shape(cropped_places, name = \"Localités\") +\n  tm_dots(size = \"size_dot\", size.max = 0.05, col = \"Chef_lieu\",\n          palette = c(\"lightgrey\", \"grey\", \"darkgrey\", \"black\"),\n                      id = \"PLACE_NAME\",\n                      popup.vars = c(\"PLACE_NAME\",\n                                     \"FOKONTANY\",\n                                     \"COMMUNE\")) +\n  tm_shape(makay_union, name = \"Périmètre exterieur de l'AP\") +\n  tm_borders(col = \"darkgreen\", lwd = 2) + \n  tm_add_legend(type = \"fill\", col = \"darkgreen\", labels = \"AP Makay\") +\n  tm_shape(cropped_fokontany, name = \"Fokontany\") +\n  tm_borders(col = \"grey\") +\n  tm_fill(alpha = 0, id = \"Fokontany\",\n          popup.vars = c(\"Fokontany\",\n                         \"Population 2018 (estimation)\",\n                         \"Commune\")) +\n  tm_shape(cropped_communes, name = \"Communes\") +\n  tm_borders(col = \"black\")  +\n  tm_basemap(\"OpenStreetMap\") +\n  tm_view(dot.size.fixed = FALSE, set.view = 9)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Carte générale</span>"
    ]
  },
  {
    "objectID": "mission_Makay_2023_10.html",
    "href": "mission_Makay_2023_10.html",
    "title": "6  Analyse spécifique pour la mission d’octobre 2023",
    "section": "",
    "text": "6.1 Objet\nL’objectif de cette note est de guider les chercheuses et chercheurs effectuant une mission de terrain dans le Makay début octobre. Il s’agit de nourrir l’articulation entre les bras socioéconomique, ethnoécologique et anthropologique de l’étude en documentant à partir de sources tierces (données satellitaires principalement) des évènements concrets susceptibles d’être appréhendées dans chacun des bras. On a ainsi identifié des passages de cyclones, feux de brousse/forêt et périodes de pluie/sécheresse. De par leur nature, ces évènements concrets sont circonscrits dans le temps et l’espace et documenter leur chronologie et leur localisation dans les enquêtes de chacun des bras favorisera l’étalonnage, la comparabilité et les échanges entre les bras. Concrètement, un feu de brousse de grande ampleur survenu dans une zone déterminée est susceptible d’influencer les résultats de l’enquête OR pour les localités avoisinantes (bras socioéconomique), les écosystèmes et leur perception par les populations locales (bras ethnoécologique), ou encore les représentations captées par le bras anthropologique.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Analyse spécifique pour la mission d'octobre 2023</span>"
    ]
  },
  {
    "objectID": "mission_Makay_2023_10.html#méthodologie",
    "href": "mission_Makay_2023_10.html#méthodologie",
    "title": "6  Analyse spécifique pour la mission d’octobre 2023",
    "section": "6.2 Méthodologie",
    "text": "6.2 Méthodologie\nPar souci de transparence et pour être en mesure de reproduire les analyses plus tard, en actualisant ou non les données sources, on travaille sur R en mode notebook. Un seul document, archivé et versionné de manière rigoureuse, contient à la fois le texte d’analyse, les traitements de données (bloc de code ci-dessous) et les visualisations de résultats.\n\n\nCode\n# Ci-dessous les librairies R utilisées pour cette analyse\nlibrary(tidyverse) # pour la manipulation et visualisation de données\nlibrary(sf) # pour traiter les données spatiales\nlibrary(tmap) # pour générer des cartes\nlibrary(aws.s3) # Pour accéder aux données volumineuses stockées en ligne\nlibrary(geodata) # Pour avoir les frontières administratives\nlibrary(curl) # Pour télécharge\nlibrary(lubridate) # Pour manipuler des dates\nlibrary(httr)\nlibrary(mapme.biodiversity)\n\n\nNous avons les coordonnées suivantes:\n\nBeroroha 21°40.504’S – 45°9.571’E\nBeronono 21°21.669’S – 45°14.885’E\nTsivoko 21°17.712’S – 45°22.732’E\nMakaykely 21°28.074’S - 45°21.896’E\nBivouac 21°13.369’S – 45°19.516’E\n\n(Il s’agit d’un format “Degree Decimal Minutes (DDM)”: pas de secondes fournies, mais des décimales de minutes).\nNous les importons et les visualisons :\n\n\nCode\n# Create a dataframe of the coordinates\ncoordinates &lt;- data.frame(\n  location = c(\"Beroroha\", \"Beronono\", \"Tsivoko\", \"Makaykely\", \"Bivouac\"),\n  latitude = c(\"21°40.504’S\", \"21°21.669’S\", \"21°17.712’S\", \"21°28.074’S\", \"21°13.369’S\"),\n  longitude = c(\"45°9.571’E\", \"45°14.885’E\", \"45°22.732’E\", \"45°21.896’E\", \"45°19.516’E\")\n)\n\n# Function to parse DMS and convert to decimal degrees\nddm_to_decimal &lt;- function(dms){\n  # Extraire les degrés, minutes et secondes\n  parts &lt;- regmatches(dms, gregexpr(\"[0-9.]+\", dms))[[1]]\n  degree &lt;- as.numeric(parts[1])\n  minute &lt;- as.numeric(parts[2]) / 60\n  direction &lt;- ifelse(grepl(\"S|W\", dms), -1, 1)\n  \n  # Converstion au format décimal\n  decimal &lt;- direction * (degree + minute)\n  \n  return(decimal)\n}\n\n\n# Apply function to each coordinate\ncoordinates$latitude_decimal &lt;- sapply(coordinates$latitude, ddm_to_decimal)\ncoordinates$longitude_decimal &lt;- sapply(coordinates$longitude, ddm_to_decimal)\n\n# Convertir les coordonnées en objet sf\ncoordinates_sf &lt;- st_as_sf(coordinates, \n                           coords = c(\"longitude_decimal\", \"latitude_decimal\"), \n                           crs = 4326)\n\n\nmakay_ap &lt;- st_read(\"data/Makay_wgs84.geojson\", quiet = TRUE) %&gt;%\n  rename(Statut = SOURCETHM) %&gt;%\n  mutate(Statut = recode(Statut, \"zone tampon\" = \"Zone tampon\"))\n\n# Fusion des différentes aires\nmakay_union &lt;- makay_ap %&gt;%\n  st_union() %&gt;%\n  st_sf() %&gt;%\n  st_make_valid()\n\n# Carte superposant les différentes informations\ntmap_mode(\"view\")\ntm_shape(makay_ap) +\n  tm_polygons(col = \"Statut\", alpha = 0.5) +\n  tm_shape(makay_union) +\n  tm_borders(col = \"darkblue\") + \n  tm_shape(coordinates_sf) +\n  tm_dots(col = \"black\", size = 0.1, labels = coordinates_sf$location) +\n  tm_text(text = \"location\", ymod = -0.5) +\n  tm_basemap(\"OpenStreetMap\") +\n  tm_layout(title = \"Locations\", main.title.size = 1.5) +\n  tm_add_legend(type = \"fill\", col = \"darkblue\", labels = \"Limite externe\") +\n  tm_scale_bar()\n\n\n\n\n\n\nLocalisation prévue des visites de terrain\n\n\nA partir de cette information, on va visualiser des informations récentes qui seraient intéressantes à documenter lors des entretiens de terrain.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Analyse spécifique pour la mission d'octobre 2023</span>"
    ]
  },
  {
    "objectID": "mission_Makay_2023_10.html#feux-de-brousse",
    "href": "mission_Makay_2023_10.html#feux-de-brousse",
    "title": "6  Analyse spécifique pour la mission d’octobre 2023",
    "section": "6.3 Feux de brousse",
    "text": "6.3 Feux de brousse\nPour cette visualisation, nous avons mobilisé des données provenant du satellite VIIRS (Visible Infrared Imaging Radiometer Suite). Les données téléchargées depuis le service FIRMS de la NASA portent uniquement sur les deux derniers mois. Elles incluent plusieurs variables, parmi lesquelles nous utilisons principalement la variable ‘frp’ (Fire Radiative Power) pour représenter l’intensité des incendies. Cette variable, exprimée en mégawatts (MW), quantifie le taux d’émission radiative des feux actifs, offrant une indication directe de l’intensité du feu. De plus, nous avons défini une zone d’intérêt autour de la zone où l’enquête terrain sera réalisé et nous visualisons les données à l’intérieur de cette zone. La carte finale montre ces incendies avec une gradation de couleurs pour refléter l’intensité de chaque incendie.En cliquant sur les points, on peut consulter la date à laquelle le foyer a été enregistré par le satellite, ainsi que la probabilité qu’il s’agisse téellement d’un feu (classé en “élevée”, “nominale” et “faible”).\n\n\nCode\n# Find my token\nif (Sys.info()[\"effective_user\"] == \"onyxia\") {\n  system(\"vault kv get -format=table onyxia-kv/fbedecarrats/earth_data\", \n         intern = TRUE) -&gt; my_secret \n  my_key_api &lt;- my_secret %&gt;%\n    pluck(17) %&gt;%\n    str_remove(\"^\\\\b\\\\w+\\\\b *\")\n} else { # otherwise you need to store your file encryption key \n  # in a file named secret_zip_key\n  my_key_api &lt;- readLines(\"secret_api_key\")\n}\n\n# Ensure folders are available\ndir.create(\"data/firms\")\ntarget_dir &lt;- \"data/firms\"\n\n# Download csv download list from NASA Earth data\ncsv_url &lt;- \"https://nrt4.modaps.eosdis.nasa.gov/api/v2/content/details/FIRMS/noaa-20-viirs-c2/Southern_Africa?fields=all&formats=csv\"\ncsv_file &lt;- \"firms_data.csv\"\ndownload.file(csv_url, csv_file)\n\n# Prepare download\nfirms_data &lt;- read_csv(csv_file)\n# A function to check locally and download missing files\ndownload_earthdata &lt;- function(url, outdir = \"data/firms\", \n                                   token = my_key_api) {\n  file_name &lt;- basename(url)\n  target_path &lt;- file.path(outdir, file_name)\n  header &lt;- add_headers(Authorization = paste(\"Bearer\", token))\n  # Check if the file is missing locally\n  if (!file.exists(target_path)) {\n    GET(url, header,\n        write_disk(target_path))\n   # print(url)\n  }\n}\n\n# Using purrr's map to iterate over each row of the dataframe\npurrr::map(firms_data$downloadsLink, download_earthdata)\n\n\n\n\nCode\nfirms_files &lt;- list.files(\"data/firms\", full.names = TRUE)\n\nif(!file.exists(\"data/firms_focus.rds\")) {\n  \n  \n  firms_files &lt;- list.files(\"data/firms\", full.names = TRUE)\n  col_types &lt;- read_csv(firms_files[1]) %&gt;% spec()\n  firms &lt;- map_df(\n    firms_files,\n    ~ read_csv(.x, col_types = col_types, show_col_types = FALSE)\n  )\n  \n  firms_sf &lt;- firms %&gt;%\n    st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326)\n  \n  buffer &lt;- coordinates_sf %&gt;%\n    filter(location == \"Beronono\") %&gt;%\n    st_buffer(100000)\n  \n  firms_focus &lt;- firms_sf %&gt;%\n    st_intersection(buffer)\n  \n  write_rds(firms_focus, \"data/firms_focus.rds\")\n} else {\n  firms_focus &lt;- read_rds(\"data/firms_focus.rds\")\n}\n\nbreaks_frp &lt;- c(min(firms_focus$frp), \n                median(firms_focus$frp), \n                max(firms_focus$frp))\nbreaks_frp_5 &lt;- quantile(firms_focus$frp, probs = seq(0, 1, by = 0.25), \n                         na.rm = TRUE)\n\ntm_shape(firms_focus) + \n  tm_dots(col = \"frp\", size = 0.2, alpha = 0.2, \n          palette = c(\"blue\", \"cyan\", \"yellow\", \"orange\", \"red\"),\n          border.col = NULL, breaks = breaks_frp_5,\n          popup.vars = c(\"acq_date\", \"confidence\", \"frp\"),\n          title = \"Fire radiative power\") +\n  tm_layout(title = \"Fires around Beronono\") + \n  tm_shape(makay_union) +\n  tm_borders(col = \"darkblue\") + \n  tm_shape(coordinates_sf) +\n  tm_dots(col = \"black\", size = 0.1, labels = coordinates_sf$location) +\n  tm_view(set.view = c(10)) +\n  tm_text(text = \"location\", ymod = -0.5) +\n  tm_basemap(\"OpenStreetMap\") +\n  tm_scale_bar()",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Analyse spécifique pour la mission d'octobre 2023</span>"
    ]
  },
  {
    "objectID": "mission_Makay_2024_04.html",
    "href": "mission_Makay_2024_04.html",
    "title": "7  Analyse spécifique pour la mission d’avril 2024",
    "section": "",
    "text": "7.1 Objet\nL’objectif de cette note est de guider les chercheuses et chercheurs effectuant une mission de terrain dans le Makay début octobre. Il s’agit de nourrir l’articulation entre les bras socioéconomique, ethnoécologique et anthropologique de l’étude en documentant à partir de sources tierces (données satellitaires principalement) des évènements concrets susceptibles d’être appréhendées dans chacun des bras. On a ainsi identifié des passages de cyclones, feux de brousse/forêt et périodes de pluie/sécheresse. De par leur nature, ces évènements concrets sont circonscrits dans le temps et l’espace et documenter leur chronologie et leur localisation dans les enquêtes de chacun des bras favorisera l’étalonnage, la comparabilité et les échanges entre les bras. Concrètement, un feu de brousse de grande ampleur survenu dans une zone déterminée est susceptible d’influencer les résultats de l’enquête OR pour les localités avoisinantes (bras socioéconomique), les écosystèmes et leur perception par les populations locales (bras ethnoécologique), ou encore les représentations captées par le bras anthropologique.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Analyse spécifique pour la mission d'avril 2024</span>"
    ]
  },
  {
    "objectID": "mission_Makay_2024_04.html#méthodologie",
    "href": "mission_Makay_2024_04.html#méthodologie",
    "title": "7  Analyse spécifique pour la mission d’avril 2024",
    "section": "7.2 Méthodologie",
    "text": "7.2 Méthodologie\nPar souci de transparence et pour être en mesure de reproduire les analyses plus tard, en actualisant ou non les données sources, on travaille sur R en mode notebook. Un seul document, archivé et versionné de manière rigoureuse, contient à la fois le texte d’analyse, les traitements de données (bloc de code ci-dessous) et les visualisations de résultats.\n\n\nCode\n# Ci-dessous les librairies R utilisées pour cette analyse\nlibrary(tidyverse) # pour la manipulation et visualisation de données\nlibrary(sf) # pour traiter les données spatiales\nlibrary(tmap) # pour générer des cartes\nlibrary(aws.s3) # Pour accéder aux données volumineuses stockées en ligne\nlibrary(geodata) # Pour avoir les frontières administratives\nlibrary(curl) # Pour télécharge\nlibrary(lubridate) # Pour manipuler des dates\nlibrary(httr)\nlibrary(mapme.biodiversity)\n\n\nNous avons les coordonnées suivantes:\n\nBeroroha 21°40.504’S – 45°9.571’E\nBeronono 21°21.669’S – 45°14.885’E\nTsivoko 21°17.712’S – 45°22.732’E\nMakaykely 21°28.074’S - 45°21.896’E\nBivouac 21°13.369’S – 45°19.516’E\n\n(Il s’agit d’un format “Degree Decimal Minutes (DDM)”: pas de secondes fournies, mais des décimales de minutes).\nNous les importons et les visualisons :\n\n\nCode\n# Create a dataframe of the coordinates\ncoordinates &lt;- data.frame(\n  location = c(\"Beroroha\", \"Beronono\", \"Tsivoko\", \"Makaykely\", \"Bivouac\"),\n  latitude = c(\"21°40.504’S\", \"21°21.669’S\", \"21°17.712’S\", \"21°28.074’S\", \"21°13.369’S\"),\n  longitude = c(\"45°9.571’E\", \"45°14.885’E\", \"45°22.732’E\", \"45°21.896’E\", \"45°19.516’E\")\n)\n\n# Function to parse DMS and convert to decimal degrees\nddm_to_decimal &lt;- function(dms){\n  # Extraire les degrés, minutes et secondes\n  parts &lt;- regmatches(dms, gregexpr(\"[0-9.]+\", dms))[[1]]\n  degree &lt;- as.numeric(parts[1])\n  minute &lt;- as.numeric(parts[2]) / 60\n  direction &lt;- ifelse(grepl(\"S|W\", dms), -1, 1)\n  \n  # Converstion au format décimal\n  decimal &lt;- direction * (degree + minute)\n  \n  return(decimal)\n}\n\n\n# Apply function to each coordinate\ncoordinates$latitude_decimal &lt;- sapply(coordinates$latitude, ddm_to_decimal)\ncoordinates$longitude_decimal &lt;- sapply(coordinates$longitude, ddm_to_decimal)\n\n# Convertir les coordonnées en objet sf\ncoordinates_sf &lt;- st_as_sf(coordinates, \n                           coords = c(\"longitude_decimal\", \"latitude_decimal\"), \n                           crs = 4326)\n\n\nmakay_ap &lt;- st_read(\"data/Makay_wgs84.geojson\", quiet = TRUE) %&gt;%\n  rename(Statut = SOURCETHM) %&gt;%\n  mutate(Statut = recode(Statut, \"zone tampon\" = \"Zone tampon\"))\n\n# Fusion des différentes aires\nmakay_union &lt;- makay_ap %&gt;%\n  st_union() %&gt;%\n  st_sf() %&gt;%\n  st_make_valid()\n\n# Carte superposant les différentes informations\ntmap_mode(\"view\")\ntm_shape(makay_ap) +\n  tm_polygons(col = \"Statut\", alpha = 0.5) +\n  tm_shape(makay_union) +\n  tm_borders(col = \"darkblue\") + \n  tm_shape(coordinates_sf) +\n  tm_dots(col = \"black\", size = 0.1, labels = coordinates_sf$location) +\n  tm_text(text = \"location\", ymod = -0.5) +\n  tm_basemap(\"OpenStreetMap\") +\n  tm_layout(title = \"Locations\", main.title.size = 1.5) +\n  tm_add_legend(type = \"fill\", col = \"darkblue\", labels = \"Limite externe\") +\n  tm_scale_bar()\n\n\n\n\n\n\nLocalisation prévue des visites de terrain\n\n\nA partir de cette information, on va visualiser des informations récentes qui seraient intéressantes à documenter lors des entretiens de terrain.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Analyse spécifique pour la mission d'avril 2024</span>"
    ]
  },
  {
    "objectID": "mission_Makay_2024_04.html#feux-de-brousse",
    "href": "mission_Makay_2024_04.html#feux-de-brousse",
    "title": "7  Analyse spécifique pour la mission d’avril 2024",
    "section": "7.3 Feux de brousse",
    "text": "7.3 Feux de brousse\nPour cette visualisation, nous avons mobilisé des données provenant du satellite VIIRS (Visible Infrared Imaging Radiometer Suite). Les données téléchargées depuis le service FIRMS de la NASA portent uniquement sur les deux derniers mois. Elles incluent plusieurs variables, parmi lesquelles nous utilisons principalement la variable ‘frp’ (Fire Radiative Power) pour représenter l’intensité des incendies. Cette variable, exprimée en mégawatts (MW), quantifie le taux d’émission radiative des feux actifs, offrant une indication directe de l’intensité du feu. De plus, nous avons défini une zone d’intérêt autour de la zone où l’enquête terrain sera réalisé et nous visualisons les données à l’intérieur de cette zone. La carte finale montre ces incendies avec une gradation de couleurs pour refléter l’intensité de chaque incendie.En cliquant sur les points, on peut consulter la date à laquelle le foyer a été enregistré par le satellite, ainsi que la probabilité qu’il s’agisse téellement d’un feu (classé en “élevée”, “nominale” et “faible”).\n\n\nCode\n# Find my token\nif (Sys.info()[\"effective_user\"] == \"onyxia\") {\n  system(\"vault kv get -format=table onyxia-kv/fbedecarrats/earth_data\", \n         intern = TRUE) -&gt; my_secret \n  my_key_api &lt;- my_secret %&gt;%\n    pluck(17) %&gt;%\n    str_remove(\"^\\\\b\\\\w+\\\\b *\")\n} else { # otherwise you need to store your file encryption key \n  # in a file named secret_zip_key\n  my_key_api &lt;- readLines(\"secret_api_key\")\n}\n\n# Ensure folders are available\ndir.create(\"data/firms\")\ntarget_dir &lt;- \"data/firms\"\n\n# Download csv download list from NASA Earth data\ncsv_url &lt;- \"https://nrt4.modaps.eosdis.nasa.gov/api/v2/content/details/FIRMS/noaa-20-viirs-c2/Southern_Africa?fields=all&formats=csv\"\ncsv_file &lt;- \"firms_data.csv\"\ndownload.file(csv_url, csv_file)\n\n# Prepare download\nfirms_data &lt;- read_csv(csv_file)\n# A function to check locally and download missing files\ndownload_earthdata &lt;- function(url, outdir = \"data/firms\", \n                                   token = my_key_api) {\n  file_name &lt;- basename(url)\n  target_path &lt;- file.path(outdir, file_name)\n  header &lt;- add_headers(Authorization = paste(\"Bearer\", token))\n  # Check if the file is missing locally\n  if (!file.exists(target_path)) {\n    GET(url, header,\n        write_disk(target_path))\n   # print(url)\n  }\n}\n\n# Using purrr's map to iterate over each row of the dataframe\npurrr::map(firms_data$downloadsLink, download_earthdata)\n\n\n\n\nCode\nif(!file.exists(\"data/firms_focus.rds\")) {\n  \n  \n  firms_files &lt;- list.files(\"data/firms\", full.names = TRUE)\n  col_types &lt;- read_csv(firms_files[1]) %&gt;% spec()\n  firms &lt;- map_df(\n    firms_files,\n    ~ read_csv(.x, col_types = col_types, show_col_types = FALSE)\n  )\n  \n  firms_sf &lt;- firms %&gt;%\n    st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326)\n  \n  buffer &lt;- coordinates_sf %&gt;%\n    filter(location == \"Beronono\") %&gt;%\n    st_buffer(100000)\n  \n  firms_focus &lt;- firms_sf %&gt;%\n    st_intersection(buffer)\n  \n  write_rds(firms_focus, \"data/firms_focus.rds\")\n} else {\n  firms_focus &lt;- read_rds(\"data/firms_focus.rds\")\n}\n\nbreaks_frp &lt;- c(min(firms_focus$frp), \n                median(firms_focus$frp), \n                max(firms_focus$frp))\nbreaks_frp_5 &lt;- quantile(firms_focus$frp, probs = seq(0, 1, by = 0.25), \n                         na.rm = TRUE)\n\ntm_shape(firms_focus) + \n  tm_dots(col = \"frp\",  size = 1, alpha = 0.2, \n          palette = c(\"blue\", \"cyan\", \"yellow\", \"orange\", \"red\"),\n          lwd = 0, breaks = breaks_frp_5,\n          popup.vars = c(\"acq_date\", \"confidence\", \"frp\"),\n          title = \"Fire radiative power\") +\n  tm_layout(title = \"Fires around Beronono\") + \n  tm_shape(makay_union) +\n  tm_borders(col = \"darkblue\") + \n  tm_shape(coordinates_sf) +\n  tm_dots(col = \"black\", size = 0.1, labels = coordinates_sf$location) +\n  tm_view(set.view = c(10)) +\n  tm_text(text = \"location\", ymod = -0.5) +\n  tm_basemap(\"OpenStreetMap\") +\n  tm_scale_bar()",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Analyse spécifique pour la mission d'avril 2024</span>"
    ]
  }
]